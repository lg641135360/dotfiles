#  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
#  ┃                                    TMUX CONFIGURATION                                    ┃
#  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

# ===================================
# 1. Plugins
# ===================================
set -g @plugin 'tmux-plugins/tpm'                  # Plugin manager
set -g @plugin 'tmux-plugins/tmux-sensible'        # Sensible defaults
set -g @plugin 'tmux-plugins/tmux-prefix-highlight' # Highlight when prefix is active
set -g @plugin 'catppuccin/tmux'                   # Theme

# ===================================
# 2. General Settings
# ===================================
# Terminal settings
set -g default-terminal 'tmux-256color'            # Terminal type
set -g base-index 1                                # Start window index at 1
set -g pane-base-index 1                           # Start pane index at 1
set -g renumber-windows on                         # Renumber windows when one is closed
set -g mouse on                                    # Enable mouse support

# Window settings
set -g allow-rename off                            # Don't rename windows automatically
set -g automatic-rename off

# ===================================
# 3. Theme Configuration
# ===================================
set -g @catppuccin_flavour 'mocha'                # Theme variant
set -g @catppuccin_window_status_style "rounded"   # Window status style
set -g @catppuccin_window_number_position 'right'
set -g @catppuccin_window_status 'no'
set -g @catppuccin_window_default_text '#W'
set -g @catppuccin_window_current_fill 'number'
set -g @catppuccin_window_current_text '#W'
set -g @catppuccin_window_current_color '#{E:@thm_surface_2}'
set -g @catppuccin_date_time_text '%d.%m. %H:%M'
set -g @catppuccin_status_module_text_bg '#{E:@thm_mantle}'

# Status line configuration
set -g status-interval 5
set -g status-right-length 100
set -g status-left-length 100
set -g status-right "#{prefix_highlight} #{E:@catppuccin_status_application}"

# ===================================
# 4. Keybindings
# ===================================
# Prefix
set -g prefix C-a                                  # Change prefix from C-b to C-a
unbind C-b                                         # Remove old prefix

# Pane navigation
bind -n M-Left select-pane -L                      # Move left
bind -n M-Right select-pane -R                     # Move right
bind -n M-Up select-pane -U                        # Move up
bind -n M-Down select-pane -D                      # Move down

# Window operations
bind | split-window -h                             # Split horizontally
bind - split-window -v                             # Split vertically
bind r source-file ~/.tmux.conf \; display "Config reloaded!"  # Reload config

# ===================================
# 5. Copy Mode
# ===================================
# Basic Usage:
#   1. Enter copy mode: prefix + [  (prefix is Ctrl+a)
#   2. Navigation:
#      - h,j,k,l: move cursor
#      - w/b: next/previous word
#      - f/F: find character forward/backward
#      - Ctrl+u/d: page up/down
#      - g/G: go to top/bottom
#   3. Selection:
#      - v: start selection
#      - C-v: rectangle selection
#      - y: copy and exit
#      - q: quit without copying
#   4. Search:
#      - /: search forward
#      - ?: search backward
#      - n/N: next/previous match

# Vi mode
setw -g mode-keys vi                               # Use vi keys in copy mode
set-window-option -g mode-keys vi                  # Enable vi mode

# Copy mode bindings
bind-key -T copy-mode-vi v send-keys -X begin-selection     # Begin selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle  # Toggle rectangle selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel  # Copy selection

# ===================================
# 6. Plugin Settings
# ===================================
# Prefix Highlight
set -g @prefix_highlight_show_copy_mode 'on'       # Show copy mode
set -g @prefix_highlight_copy_mode_attr 'fg=white,bg=blue'  # Copy mode style

# Other Bindings
bind-key s setw synchronize-panes                  # Toggle sync panes

# ===================================
# 7. Plugin Manager (keep at bottom)
# ===================================
run ~/.tmux/plugins/tmux/catppuccin.tmux           # Load theme
run '~/.tmux/plugins/tpm/tpm'                      # Initialize plugin manager
